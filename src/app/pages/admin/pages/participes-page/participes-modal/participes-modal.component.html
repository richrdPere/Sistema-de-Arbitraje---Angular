<!-- MODAL CREAR PARTICIPE -->
@if (mostrarModal) {
<div class="modal modal-open">
  <div class="modal-box bg-base-100 text-base-content rounded-2xl shadow-lg">
    <!-- Header -->
    <div class="flex justify-between items-center border-b border-base-300 pb-3 mb-4">
      <h3 class="text-xl font-semibold">Crear Nuevo Participe</h3>
      <button type="button" (click)="cerrarModal()" class="btn btn-sm btn-ghost text-xl">&times;</button>
    </div>

    <!-- Mensajes -->
    @if (mensajeError) {
    <div class="alert alert-error text-sm mb-3 shadow-sm">
      <span>{{ mensajeError }}</span>
    </div>
    }

    @if (mensajeExito) {
    <div class="alert alert-success text-sm mb-3 shadow-sm">
      <span>{{ mensajeExito }}</span>
    </div>
    }


    <!-- Formulario -->
    <form [formGroup]="formParticipe" (ngSubmit)="crearParticipe()" class="space-y-4">

      <!-- Campos básicos -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
        <div class="form-control">
          <label class="label">
            <span class="label-text">Nombre</span>
          </label>
          <input type="text" formControlName="nombre" placeholder="Ej. Juan" class="input input-bordered w-full"
            [class.input-error]="f['nombre'].invalid && f['nombre'].touched" />

          @if (f['nombre'].invalid && f['nombre'].touched) {
          <small class="text-error text-xs">
            Nombre requerido (mínimo 3 caracteres)
          </small>
          }
        </div>

        <div class="form-control">
          <label class="label">
            <span class="label-text">Apellidos</span>
          </label>
          <input type="text" formControlName="apellidos" placeholder="Ej. Pérez López"
            class="input input-bordered w-full"
            [class.input-error]="f['apellidos'].invalid && f['apellidos'].touched" />
          @if (f['apellidos'].invalid && f['apellidos'].touched) {
          <small class="text-error text-xs">
            Apellidos requeridos (mínimo 3 caracteres)
          </small>
          }
        </div>
      </div>

      <div class="form-control">
        <label class="label">
          <span class="label-text">Correo</span>
        </label>
        <input type="email" formControlName="correo" placeholder="ejemplo@correo.com"
          class="input input-bordered w-full" [class.input-error]="f['correo'].invalid && f['correo'].touched" />
        @if (f['correo'].invalid && f['correo'].touched) {
        <small class="text-error text-xs">
          Ingrese un correo válido.
        </small>
        }

      </div>

      <div class="form-control">
        <label class="label">
          <span class="label-text">Contraseña</span>
        </label>
        <input type="password" formControlName="password" placeholder="********" class="input input-bordered w-full"
          [class.input-error]="f['password'].invalid && f['password'].touched" />

        @if (f['password'].invalid && f['password'].touched) {
        <small class="text-error text-xs">
          Mínimo 6 caracteres.
        </small>
        }
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-4">
        <div class="form-control">
          <label class="label">
            <span class="label-text">Teléfono</span>
          </label>
          <input type="text" formControlName="telefono" placeholder="987654321" class="input input-bordered w-full"
            [class.input-error]="f['telefono'].invalid && f['telefono'].touched" />
          @if (f['telefono'].invalid && f['telefono'].touched) {
          <small class="text-error text-xs">
            Solo se permiten números.
          </small>
          }

        </div>

        <div class="form-control">
          <label class="label">
            <span class="label-text">Documento de Identidad</span>
          </label>
          <input type="text" formControlName="documento_identidad" placeholder="DNI / RUC"
            class="input input-bordered w-full" />
        </div>

        <div class="form-control">
          <label class="label">
            <span class="label-text">Cargo</span>
          </label>
          <input type="text" formControlName="cargo" placeholder="Ej. Representante Legal"
            class="input input-bordered w-full" [class.input-error]="f['cargo'].invalid && f['cargo'].touched" />
          @if (f['cargo'].invalid && f['cargo'].touched) {
          <small class="text-error text-xs">
            Este campo es obligatorio.
          </small>
          }

        </div>
      </div>


      <div class="form-control mt-2">
        <label class="label">
          <span class="label-text">Rol del Partícipe</span>
        </label>
        <select formControlName="rol_participe" class="select select-bordered w-full"
          [class.select-error]="f['rol_participe'].invalid && f['rol_participe'].touched">
          <option value="" disabled selected>Seleccione un rol</option>
          <option value="Demandante">Demandante</option>
          <option value="Demandado">Demandado</option>
          <option value="Árbitro">Árbitro</option>
          <option value="Adjudicador">Adjudicador</option>
          <option value="Secretaria">Secretaria</option>
          <option value="Perito">Perito</option>
          <option value="Testigo">Testigo</option>
        </select>
        @if (f['rol_participe'].invalid && f['rol_participe'].touched) {
        <small class="text-error text-xs">
          Seleccione un rol válido.
        </small>
        }

      </div>
      <!-- Footer Buttons -->
      <div class="modal-action flex justify-end items-center gap-3">
        <button type="button" class="btn btn-ghost" (click)="cerrarModal()">Cancelar</button>
        <button type="submit" class="btn btn-primary text-white" [disabled]="formParticipe.invalid || cargando">
          @if (cargando) {
          <span class="loading loading-spinner loading-sm"></span>
          Creando...
          } @else {
          Guardar Partícipe
          }
        </button>
      </div>
    </form>

  </div>
  <!-- Fondo oscuro del modal -->
  <div class="modal-backdrop bg-black/40 " (click)="cerrarModal()"></div>
</div>
}
