<section class="relative min-h-screen ">

  <div class="relative min-h-screen bg-cover bg-center" style="background-image: url('assets/bg-justicia.jpg');">

    <!-- Overlay oscuro -->
    <div class="absolute inset-0 bg-black/40 "></div>

    <div class="flex flex-col items-center justify-center px-4 py-10">
      <div class="card w-full max-w-md bg-base-100 shadow-xl">
        <div class="card-body space-y-5">
          <h2 class="text-center text-xl font-bold text-info">
            Consulta de Expediente
          </h2>

          <!-- FORMULARIO -->
          <form [formGroup]="formConsulta" (ngSubmit)="consultarExpediente()" class="space-y-4">
            <div class="form-control">
              <label class="label">
                <span class="label-text pb-3">Número de expediente</span>
              </label>
              <input type="text" formControlName="numeroExpediente" placeholder="Ej: EXP-2025-001"
                class="input input-bordered w-full" />
              @if (formConsulta.controls['numeroExpediente'].invalid &&
              formConsulta.controls['numeroExpediente'].touched) {
              <span class="text-error text-sm mt-1">Ingrese un número válido.</span>
              }
            </div>

            <button type="submit" class="btn btn-primary w-full" [disabled]="cargando || formConsulta.invalid">
              @if (cargando) {
              <span class="loading loading-spinner"></span> Consultando...
              } @else {
              Consultar
              }
            </button>
          </form>

          <!-- MENSAJES DE ERROR -->
          @if (errorMsg) {
          <div class="alert alert-error text-sm text-white">
            {{ errorMsg }}
          </div>
          }

          <!-- RESULTADO -->
          @if (resultado) {
          <div class="mt-5 p-4 bg-base-300 rounded-lg space-y-2">
            <h3 class="text-lg font-bold text-center text-info">Resultado</h3>

            <div class="space-y-2">
              <p><strong>N° Expediente:</strong> {{ resultado.numero_expediente }}</p>
              <p><strong>Tipo:</strong> {{ resultado.tipo_proceso }}</p>
              <p><strong>Estado actual:</strong> {{ resultado.estado_actual }}</p>
              <p><strong>Última actualización:</strong> {{ resultado.fecha_actualizacion | date:'mediumDate' }}</p>
            </div>

            <!-- Avance del proceso -->
            @if (resultado.avance) {
            <div class="mt-3">
              <progress class="progress progress-info w-full" [value]="resultado.avance" max="100"></progress>
              <p class="text-center text-sm mt-1">Avance: {{ resultado.avance }}%</p>
            </div>
            }

            <button class="btn btn-ghost w-full mt-3" (click)="reset()">Nueva consulta</button>
          </div>
          }
        </div>
      </div>
    </div>


  </div>


</section>
