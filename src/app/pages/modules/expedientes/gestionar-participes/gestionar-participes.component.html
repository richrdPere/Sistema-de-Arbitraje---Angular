<div class="p-6">

  <h2 class="text-2xl font-bold mb-4">Designación de Árbitros</h2>

  <button class="btn btn-outline mb-6" (click)="router.navigate(['/app/expedientes'])">
    ← Volver
  </button>

  <!-- LOADING -->
  <ng-container *ngIf="loading; else contenido">
    <div class="flex justify-center py-10">
      <span class="loading loading-spinner loading-lg"></span>
    </div>
  </ng-container>

  <ng-template #contenido>

    <!-- EXPEDIENTE -->
    <div class="card bg-base-200 p-4 mb-6 shadow">
      <h3 class="font-semibold text-lg">
        Expediente {{ expediente?.numero_expediente }}
      </h3>
      <p><strong>Estado:</strong> {{ expediente?.estado }}</p>
      <p><strong>Inicio:</strong> {{ expediente?.fecha_inicio | date:'dd/MM/yyyy' }}</p>
    </div>

    <!-- PARTICIPES -->
    <div class="card bg-base-200 p-4 mb-6 shadow">
      <h3 class="font-semibold text-lg mb-2">Partícipes</h3>
      <ul class="list-disc ml-5">
        <li *ngFor="let p of participes">
          <strong>{{ p.rol_participe | uppercase }}:</strong>
          {{ p.usuario.nombre }} {{ p.usuario.apellidos }}
        </li>
      </ul>
    </div>

    <!-- DESIGNACIÓN -->
    <div class="card bg-base-100 p-6 shadow-md">

      <h3 class="text-xl font-bold mb-4">Designar Árbitros</h3>

      <!-- TIPO -->
      <label class="label font-semibold">Tipo de designación</label>
      <select
        class="select select-bordered w-full mb-6"
        [(ngModel)]="tipoSeleccionado">

        <option value="" disabled selected>Seleccione</option>
        <option value="individual">Árbitro único</option>
        <option value="tribunal">Tribunal arbitral (3 árbitros)</option>
        <!-- <option value="aleatoria">Aleatoria</option> -->
      </select>

      <!-- ÁRBITRO ÚNICO -->
      <div *ngIf="tipoSeleccionado === 'individual'" class="space-y-2">
        <label class="font-semibold">Árbitro único</label>
        <select class="select select-bordered w-full" [(ngModel)]="arbitroUnico">
          <option value="" disabled selected>Seleccione árbitro</option>
          <option *ngFor="let a of arbitrosDisponibles" [value]="a.id_arbitro">
            {{ a.usuario.nombre }} {{ a.usuario.apellidos }}
          </option>
        </select>
      </div>

      <!-- TRIBUNAL -->
      <div *ngIf="tipoSeleccionado === 'tribunal'" class="mt-6 space-y-4">

        <div>
          <label class="font-semibold">Árbitro de la Parte A</label>
          <select class="select select-bordered w-full" [(ngModel)]="arbitroDemandante">
            <option value="" disabled selected>Seleccione</option>
            <option *ngFor="let a of arbitrosDisponibles" [value]="a.id_arbitro">
              {{ a.usuario.nombre }} {{ a.usuario.apellidos }}
            </option>
          </select>
        </div>

        <div>
          <label class="font-semibold">Árbitro de la Parte B</label>
          <select class="select select-bordered w-full" [(ngModel)]="arbitroDemandado">
            <option value="" disabled selected>Seleccione</option>
            <option *ngFor="let a of arbitrosDisponibles" [value]="a.id_arbitro">
              {{ a.usuario.nombre }} {{ a.usuario.apellidos }}
            </option>
          </select>
        </div>

        <div>
          <label class="font-semibold">Árbitro Institucional</label>
          <select class="select select-bordered w-full" [(ngModel)]="arbitroInstitucion">
            <option value="" disabled selected>Seleccione</option>
            <option *ngFor="let a of arbitrosDisponibles" [value]="a.id_arbitro">
              {{ a.usuario.nombre }} {{ a.usuario.apellidos }}
            </option>
          </select>
        </div>

      </div>

      <!-- GUARDAR -->
      <button
        class="btn btn-primary w-full mt-8"
        [disabled]="loading"
        (click)="guardarDesignacion()">

        Guardar Designación
      </button>

    </div>

  </ng-template>

</div>


